# HTTP

## Введение

Аббревиатура `HTTP` расшифровывается как `HyperText Transfer Protocol`, «протокол передачи гипертекста». `HTTP` является протоколом прикладного уровня по модели OSI (верхнего, 7-го).

`HTTP` — широко распространённый протокол передачи данных, изначально предназначенный для передачи гипертекстовых документов(`HTML`-страниц), в настоящий момент используется для передачи произвольных данных.

Какие задачи решает `HTTP`?
* Структура данных, передаваемых по сети.
  
  Данные передаются по `TCP` сплошным потоком байт, клиент и сервер, которые взаимодействуют по `TCP` должны каким-то образом договориться когда можно считать, что запрос закончен, когда можно считать, что ответ получен? Нужна внутренняя структура для данных.

* Передача мета-информации о документе.

    MIME-type(Content-type), размер документа и т.д.

* Авторизация.
    
    Передаваемые документы могут быть как публичными, так и приватными. Для обеспечения приватности нужна проверка прав доступа, авторизация.

* Поддержка сессий.
* Кеширование документов.
* Согласование содержимого.
  
  Клиент и сервер могут договориться в каком виде передавать документ, например, сжимать его и по какому протоколу это делать.
* Управление соединением.
    Протокол `TCP` не предусматривает управления, кроме как закрытия соединения. Протокол `HTTP` позволяет более гибко управлять соединением, в частности, закрывать его или оставлять открытым для последующих запросов.

Ключевые особенности:

* Работает поверх `TCP/TLS`.
* Протокол `HTTP` работает по принципу запрос-ответ.
* Это `stateless` протокол, он не хранит состояние о соединении.
* Является текстовым протоколом, данные передаются в виде `plain` текста.
* Расширяемый протокол. Можно вводить дополнительные заголовки.

// Пример запрос-ответа

Задача, которую необходимо было решить в первую очередь - это указать Content-type документа и его длину.

## HTTP методы

HTTP методы:
* GET - получение документа.
* HEAD - получение только заголовков и статуса ответа.
  
    Для проверки наличия документа, например, поисковыми ботами.

* POST - отправка данных на сервер.

    Данные могут быть произвольными.

* PUT - отправка документа на сервер.
  
  Отправка данных, но отправка документа целиком. Обычно отключен в целях безопасности.
* DELETE - удаление документа.
  
  Обычно отключен в целях безопасности.
* CONNECT, TRACE, OPTIONS

    Для получения информации о веб-сервере.


## HTTP коды ответа

HTTP коды ответа:

* 1xx - информационные.

    Для координации действий клиента и веб-сервера.

* 2xx - упешное выполнение
  
  Примеры: 
   * 200 OK - запрос успешно выполнен, в теле ответа будет документ для клиента.
   * 204 No Content - запрос успешно выполнен, но документ пуст.


* 3xx - перенаправление
  
    Документ может быть получен с другого URL, существуют другие версии документа и т.д.

    Примеры:
    * 301 Moved Permanently - документ сменил URL. Может кешироваться на стороне браузера.
    * 302 Found - повторить запрос по другому URL. Не кешируется.
    * 304 Not Modified - документ не изменился, использовать кеш.

* 4xx - ошибка на стороне клиента
  
  Запрос осуществить не удалось и проблема у клиента.
  
  Примеры:
    * 400 Bad Request - неправильный синтаксис запроса.
    * 401 Unauthorized - требуется авторизация.
    * 403 Forbidden - нет доступа.
    * 404 Not Found - документ не найден.
  
* 5xxx - ошибка на стороне сервера

  Примеры:
    * 500 Internal Server Error - неожиданная ошибка сервера.
    * 502 Bad Gateway - проксируемый сервер отвечает с ошибкой.
    * 504 Gateway Timeout - проксируемый сервер не отвечает.

## Заголовки HTTP запросов

### Общие

* Content-Type - MIME тип документа.
* Content-Length - длина сообщения.
* Content-Encoding - кодирование документа, например, gzip-сжатие.
* Transfer-Encoding - формат передачи, например, chunked - передача частями.
* Connection - управление соединением. В `HTTP 1.1` предполагается удержание соединения, если не передано `close`.

### Остальные

* Authorization - авторизация, логин/пароль.
* Cookie - передача состояниея(сессии) на сервер. Так как сервер не поддерживает постоянное соединение с пользователем и должен понимать, что за пользователь пришел, то используют информацию о сессии, передавая ее в заголовке Cookie.
* Refer - URL предыдущего документа, контекст запроса. Например, с какого сайта перешли на нашу страничку.
* User-Agent - описание web-слиента, версия браузера.
* If-Modified-Since - условный GET запрос.
* Accept:* - согласование содержимого. Договоренности какие документы браузер готов принять(сжатые, кодировка и т.д.).